<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Discord Admin</title>
  <style>
    :root{--bg:#0f1115;--panel:#161922;--muted:#8b93a7;--text:#e6e9f2;--accent:#5b8cff;--ok:#2ecc71;--err:#e74c3c;--border:#23283a}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(120deg,#0e1014,#0c0f19);color:var(--text);font:16px/1.45 system-ui,Segoe UI,Roboto,Inter,Arial}
    .wrap{max-width:1100px;margin:24px auto;padding:0 16px}
    header{display:flex;gap:12px;align-items:center;margin-bottom:18px}
    header h1{font-size:22px;margin:0}
    .grid{display:grid;grid-template-columns:1.1fr .9fr;gap:16px}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    .card h2{margin:0 0 12px;font-size:16px;color:#cfd6ea}
    label{display:block;font-size:13px;color:var(--muted);margin:10px 0 6px}
    input[type="text"], input[type="url"], textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:#0e1220;color:var(--text);outline:none}
    textarea{min-height:110px;resize:vertical}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:12px}
    button{border:0;border-radius:12px;padding:10px 14px;cursor:pointer;font-weight:600}
    .primary{background:var(--accent);color:white}
    .ghost{background:#0f1322;color:#cbd5ff;border:1px solid var(--border)}
    .danger{background:var(--err);color:white}
    .muted{color:var(--muted)}
    .status{margin-top:10px;font-size:14px;min-height:22px}
    .badge{display:inline-block;padding:3px 8px;border-radius:999px;font-size:12px;border:1px solid var(--border);background:#0f1322;color:#cbd1e6}
    .preview{background:#0c0f1a;border-radius:12px;border:1px dashed #2a3150;padding:14px;min-height:160px}
    .flex{display:flex;align-items:center;gap:10px}
    .spacer{height:8px}
    .tip{font-size:12px;color:#a5aec5}
    .footer{margin-top:18px;font-size:12px;color:#98a1b8}
    .switch{display:inline-flex;align-items:center;gap:8px}
    .switch input{width:18px;height:18px}
    code{background:#0d1224;color:#bcd0ff;border:1px solid #253056;padding:2px 6px;border-radius:6px}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 3h8a3 3 0 0 1 3 3v12a3 3 0 0 1-3 3H8a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3Z" stroke="#5b8cff" stroke-width="1.5"/><path d="M7.5 8.5h9M7.5 12h9M7.5 15.5h6" stroke="#9fb6ff" stroke-width="1.5" stroke-linecap="round"/></svg>
      <h1>The Shadow Announcements</h1>
      <span class="badge">A jeremiaxavier software</span>
    </header>

    <div class="grid">
      <!-- Builder -->
      <section class="card">
        <h2>Message & Embed</h2>

        <label>Webhook URL <span class="tip">(stored locally)</span></label>
        <input type="url" id="webhook" placeholder="https://discord.com/api/webhooks/â€¦" />

        <div class="row">
          <div>
            <label>Username (optional)</label>
            <input type="text" id="username" placeholder="Announcement Bot" />
          </div>
          <div>
            <label>Avatar URL (optional)</label>
            <input type="url" id="avatar" placeholder="https://â€¦/avatar.png" />
          </div>
        </div>

        <label>Plain Message Content (optional)</label>
        <textarea id="content" placeholder="This appears above the embedâ€¦"></textarea>

        <div class="spacer"></div>
        <h2>Embed Fields</h2>

        <label>Title</label>
        <input type="text" id="title" placeholder="ðŸš€ New Update Released!" />

        <label>Description</label>
        <textarea id="description" placeholder="Markdown supported: **bold**, *italics*, [links](https://example.com)"></textarea>

        <div class="row">
          <div>
            <label>Color</label>
            <div class="flex">
              <input type="color" id="colorpicker" value="#5b8cff" />
              <input type="text" id="colorhex" class="mono" placeholder="#5b8cff" value="#5b8cff" />
            </div>
            <div class="tip">You can paste HEX (e.g. <code>#00ff88</code>)</div>
          </div>
          <div>
            <label>Footer Text (optional)</label>
            <input type="text" id="footer" placeholder="Server Announcements" />
          </div>
        </div>

        <div class="row">
          <div>
            <label>Thumbnail URL (optional)</label>
            <input type="url" id="thumb" placeholder="https://â€¦/thumb.png" />
          </div>
          <div>
            <label>Image URL (optional)</label>
            <input type="url" id="image" placeholder="https://â€¦/banner.png" />
          </div>
        </div>

        <div class="controls">
          <label class="switch"><input type="checkbox" id="timestamp" checked /> Include timestamp</label>
          <button class="ghost" id="save">Save Settings</button>
          <button class="ghost" id="previewBtn">Preview</button>
          <button class="primary" id="send">Send to Discord</button>
          <button class="danger" id="clear">Clear</button>
        </div>
        <div id="status" class="status muted"></div>
      </section>

      <!-- Live Preview -->
      <section class="card">
        <h2>Live Preview</h2>
        <div id="preview" class="preview muted">Fill in fields and click <b>Preview</b>.</div>
        <div class="footer">Tip: Keep your webhook URL private. Anyone with it can post to that channel.</div>
      </section>
    </div>

    <div class="footer">Powered by Jeremiaxaviersoftwares. Works entirely in your browser.</div>
  </div>

  <script>
    const els = {
      webhook: document.getElementById('webhook'),
      username: document.getElementById('username'),
      avatar: document.getElementById('avatar'),
      content: document.getElementById('content'),
      title: document.getElementById('title'),
      description: document.getElementById('description'),
      colorpicker: document.getElementById('colorpicker'),
      colorhex: document.getElementById('colorhex'),
      footer: document.getElementById('footer'),
      thumb: document.getElementById('thumb'),
      image: document.getElementById('image'),
      timestamp: document.getElementById('timestamp'),
      status: document.getElementById('status'),
      preview: document.getElementById('preview'),
      save: document.getElementById('save'),
      send: document.getElementById('send'),
      clear: document.getElementById('clear'),
      previewBtn: document.getElementById('previewBtn'),
    };

    // Local storage load/save
    (function load(){
      const data = JSON.parse(localStorage.getItem('dabuilder')||'{}');
      Object.entries(data).forEach(([k,v]) => { if (els[k]) els[k].value = v; });
      if (data.colorhex) els.colorpicker.value = data.colorhex;
    })();

    function save(){
      const keys = ['webhook','username','avatar','colorhex'];
      const data = {}; keys.forEach(k=>data[k]=els[k].value.trim());
      localStorage.setItem('dabuilder', JSON.stringify(data));
      toast('Settings saved.');
    }

    function toast(msg, ok){
      els.status.textContent = msg;
      els.status.style.color = ok ? 'var(--ok)' : 'var(--muted)';
    }

    function hexToDec(hex){
      if(!hex) return null;
      hex = hex.trim().toLowerCase();
      if(hex.startsWith('#')) hex = hex.slice(1);
      if(!/^([0-9a-f]{6})$/.test(hex)) return null;
      return parseInt(hex, 16);
    }

    function buildPayload(){
      const colorDec = hexToDec(els.colorhex.value) ?? hexToDec(els.colorpicker.value);
      const embed = {};
      if (els.title.value.trim()) embed.title = els.title.value.trim();
      if (els.description.value.trim()) embed.description = els.description.value.trim();
      if (colorDec !== null) embed.color = colorDec;
      if (els.footer.value.trim()) embed.footer = { text: els.footer.value.trim() };
      if (els.thumb.value.trim()) embed.thumbnail = { url: els.thumb.value.trim() };
      if (els.image.value.trim()) embed.image = { url: els.image.value.trim() };
      if (els.timestamp.checked) embed.timestamp = new Date().toISOString();

      const payload = { embeds: [embed] };
      if (els.content.value.trim()) payload.content = els.content.value.trim();
      if (els.username.value.trim()) payload.username = els.username.value.trim();
      if (els.avatar.value.trim()) payload.avatar_url = els.avatar.value.trim();

      return payload;
    }

    function renderPreview(){
      const p = buildPayload();
      const embed = p.embeds[0];
      const color = (embed.color != null) ? '#' + embed.color.toString(16).padStart(6,'0') : '#5865F2';

      els.preview.innerHTML = `
        <div style="display:flex; gap:12px; align-items:flex-start;">
          <div style="flex:0 0 44px; height:44px; border-radius:50%; background:#1a2036;"></div>
          <div style="flex:1">
            ${p.content ? `<div style='margin-bottom:6px; white-space:pre-wrap;'>${escapeHtml(p.content)}</div>` : ''}
            <div style="border-left:4px solid ${color}; background:#0f1426; border-radius:8px; padding:10px 12px;">
              ${embed.title ? `<div style='font-weight:700; margin-bottom:6px;'>${escapeHtml(embed.title)}</div>`:''}
              ${embed.description ? `<div style='white-space:pre-wrap;'>${formatMarkdown(embed.description)}</div>`:''}
              ${embed.image?.url ? `<div style='margin-top:10px'><img src='${embed.image.url}' alt='embed image' style='max-width:100%; border-radius:8px;'/></div>`:''}
              <div style="display:flex; justify-content:space-between; align-items:center; gap:8px; margin-top:8px; color:#9aa4c7; font-size:12px;">
                ${embed.footer?.text ? `<span>${escapeHtml(embed.footer.text)}</span>`:''}
                ${embed.timestamp ? `<span>${new Date(embed.timestamp).toLocaleString()}</span>`:''}
              </div>
            </div>
          </div>
        </div>`;
    }

    function escapeHtml(s){
      return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c]));
    }

    // very small markdown formatter for bold/italic/inline links
    function formatMarkdown(s){
      let out = escapeHtml(s);
      out = out.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
      out = out.replace(/\*(.*?)\*/g, '<i>$1</i>');
      out = out.replace(/`([^`]+)`/g, '<code>$1</code>');
      out = out.replace(/\[(.*?)\]\((https?:[^\s)]+)\)/g, '<a href="$2" target="_blank" rel="noopener">$1</a>');
      return out;
    }

    async function send(){
      const url = els.webhook.value.trim();
      if(!/^https:\/\/discord\.com\/api\/webhooks\//.test(url)){
        toast('Enter a valid Discord webhook URL.', false); return;
      }
      const payload = buildPayload();
      if(!payload.embeds[0].title && !payload.embeds[0].description && !payload.content){
        toast('Add at least a title/description or content.', false); return;
      }
      toast('Sendingâ€¦');
      try{
        const res = await fetch(url, {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
        if(!res.ok){
          const text = await res.text();
          throw new Error(`HTTP ${res.status}: ${text.slice(0,200)}`);
        }
        toast('Sent successfully âœ”', true);
      }catch(err){
        console.error(err);
        toast('Failed: ' + err.message, false);
      }
    }

    function clearAll(){
      ['content','title','description','footer','thumb','image'].forEach(id=>els[id].value='');
      els.timestamp.checked = true;
      renderPreview();
      toast('Cleared.');
    }

    // Sync color inputs
    els.colorpicker.addEventListener('input', e => { els.colorhex.value = e.target.value; renderPreview(); });
    els.colorhex.addEventListener('input', e => { renderPreview(); });

    // Buttons
    els.save.addEventListener('click', save);
    els.send.addEventListener('click', send);
    els.clear.addEventListener('click', clearAll);
    els.previewBtn.addEventListener('click', renderPreview);

    // Live preview on change
    ['content','title','description','footer','thumb','image','username','avatar','timestamp'].forEach(id=>{
      els[id].addEventListener('input', renderPreview);
      els[id].addEventListener('change', renderPreview);
    });

    // Initial render
    renderPreview();
  </script>
</body>
</html>

